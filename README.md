con varias cosas que arreglar, sobre todo estructura de codigo.
